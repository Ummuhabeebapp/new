<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Attendance System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background-color: #f8f9fa;
      padding: 20px;
    }
    .card {
      border-radius: 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .present {
      color: green;
      font-weight: bold;
    }
    .absent {
      color: red;
      font-weight: bold;
    }
    #adminSection {
      display: none;
    }
    #loginSection {
      display: none;
      max-width: 400px;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card p-4">
      <h2 class="text-center mb-4">üìã Daily Attendance</h2>
      <form id="attendanceForm">
        <div class="mb-3">
          <label for="attendanceDate" class="form-label">Date:</label>
          <input type="date" id="attendanceDate" class="form-control" required />
        </div>

        <table class="table table-bordered text-center">
          <thead class="table-light">
            <tr>
              <th>Student Name</th>
              <th>Mark Attendance</th>
            </tr>
          </thead>
          <tbody id="studentList"></tbody>
        </table>

        <div class="text-center">
          <button type="submit" class="btn btn-primary px-4">Save Attendance</button>
        </div>
      </form>
    </div>

    <!-- Admin Login Section -->
    <div class="card p-4 mt-4" id="loginSection">
      <h4 class="text-center mb-3">üîê Admin Login</h4>
      <form id="loginForm">
        <div class="mb-3">
          <label for="username" class="form-label">Username:</label>
          <input type="text" id="username" class="form-control" required />
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Password:</label>
          <input type="password" id="password" class="form-control" required />
        </div>
        <div class="text-center">
          <button type="submit" class="btn btn-success px-4">Login</button>
        </div>
      </form>
    </div>

    <!-- Admin Attendance Records -->
    <div class="card p-4 mt-4" id="adminSection">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="mb-0">üìÖ Attendance Records (Admin Only)</h4>
        <button class="btn btn-danger btn-sm" id="logoutBtn">Logout</button>
      </div>
      <div id="attendanceRecords"></div>
    </div>
  </div>

  <script>
    const students = [
      "Aisha", "Rahul", "Sneha", "Arjun", "Fatima", "Ravi", "Neha", "Kiran"
    ];

    const studentList = document.getElementById("studentList");
    const attendanceRecords = document.getElementById("attendanceRecords");
    const adminSection = document.getElementById("adminSection");
    const loginSection = document.getElementById("loginSection");

    // --- Populate student list ---
    students.forEach(name => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${name}</td>
        <td>
          <select class="form-select" name="${name}">
            <option value="Present">Present</option>
            <option value="Absent">Absent</option>
          </select>
        </td>
      `;
      studentList.appendChild(row);
    });

    // --- Load saved attendance ---
    function loadAttendance() {
      const saved = JSON.parse(localStorage.getItem("attendance")) || {};
      attendanceRecords.innerHTML = "";

      if (Object.keys(saved).length === 0) {
        attendanceRecords.innerHTML = "<p class='text-muted text-center'>No records yet.</p>";
        return;
      }

      for (const [date, records] of Object.entries(saved)) {
        const div = document.createElement("div");
        div.classList.add("mb-3");
        div.innerHTML = `<h6>${date}</h6>`;
        const ul = document.createElement("ul");
        ul.classList.add("list-group");
        records.forEach(r => {
          const li = document.createElement("li");
          li.classList.add("list-group-item");
          li.innerHTML = `${r.name}: <span class="${r.status === "Present" ? "present" : "absent"}">${r.status}</span>`;
          ul.appendChild(li);
        });
        div.appendChild(ul);
        attendanceRecords.appendChild(div);
      }
    }

    // --- Save attendance ---
    document.getElementById("attendanceForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const date = document.getElementById("attendanceDate").value;
      if (!date) return alert("Please select a date!");

      const attendance = [];
      students.forEach(name => {
        const status = document.querySelector(`[name="${name}"]`).value;
        attendance.push({ name, status });
      });

      const allRecords = JSON.parse(localStorage.getItem("attendance")) || {};
      allRecords[date] = attendance;
      localStorage.setItem("attendance", JSON.stringify(allRecords));

      alert("‚úÖ Attendance Saved Successfully!");
    });

    // --- Admin Login ---
    document.getElementById("loginForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;

      if (username === "RoboEdify" && password === "Robo@123Edify") {
        localStorage.setItem("adminLoggedIn", "true");
        alert("‚úÖ Login Successful!");
        showAdminSection();
      } else {
        alert("‚ùå Invalid Username or Password!");
      }
    });

    // --- Show admin section ---
    function showAdminSection() {
      loginSection.style.display = "none";
      adminSection.style.display = "block";
      loadAttendance();
    }

    // --- Logout ---
    document.getElementById("logoutBtn").addEventListener("click", () => {
      localStorage.removeItem("adminLoggedIn");
      adminSection.style.display = "none";
      loginSection.style.display = "block";
    });

    // --- Auto-show admin if logged in ---
    window.onload = () => {
      if (localStorage.getItem("adminLoggedIn") === "true") {
        showAdminSection();
      } else {
        loginSection.style.display = "block";
      }
    };
  </script>
</body>
</html>
